# Руководство по разработке чат-приложения

## Содержание

1. [Обзор проекта](#обзор-проекта)
2. [Технологический стек](#технологический-стек)
3. [Архитектура приложения](#архитектура-приложения)
4. [Установка и настройка](#установка-и-настройка)
5. [Основные компоненты](#основные-компоненты)
6. [Рекомендации по безопасности](#рекомендации-по-безопасности)
7. [Оптимизация производительности](#оптимизация-производительности)
8. [Развертывание](#развертывание)

## Обзор проекта

Это real-time чат-приложение, разработанное с использованием ASP.NET Core MVC и SignalR. Приложение поддерживает мгновенный обмен сообщениями, сохранение истории сообщений и автоматическое переподключение.

## Технологический стек

- **Backend**: ASP.NET Core 9.0
- **Frontend**: HTML, CSS, JavaScript
- **База данных**: Entity Framework Core
- **Real-time коммуникация**: SignalR
- **Аутентификация**: ASP.NET Core Identity

## Архитектура приложения

### Основные компоненты

- **ChatHub**: Центральный компонент для real-time коммуникации
- **ApplicationDbContext**: Контекст базы данных для хранения сообщений
- **Message**: Модель данных для сообщений
- **HomeController**: Контроллер для основных страниц

### Структура базы данных

```sql
CREATE TABLE Messages (
    Id INT PRIMARY KEY IDENTITY(1,1),
    UserName NVARCHAR(256),
    Content NVARCHAR(MAX),
    Timestamp DATETIME2
)
```

## Установка и настройка

1. Клонировать репозиторий:

```powershell
git clone https://github.com/Bhuuba/guid-university.git
```

2. Восстановить пакеты NuGet:

```powershell
dotnet restore
```

3. Применить миграции базы данных:

```powershell
dotnet ef database update
```

4. Запустить приложение:

```powershell
dotnet run
```

## Основные компоненты

### ChatHub (Hubs/ChatHub.cs)

- Обработка подключений/отключений пользователей
- Отправка и получение сообщений
- Загрузка истории сообщений
- Обработка повторных подключений

### Клиентский JavaScript

```javascript
// Основные функции
-connectToChat() - // Подключение к хабу
  sendMessage() - // Отправка сообщения
  loadMessageHistory() - // Загрузка истории
  handleReconnection(); // Обработка переподключения
```

## Рекомендации по безопасности

1. **Аутентификация и авторизация**

   - Использовать ASP.NET Core Identity
   - Настроить политики CORS
   - Включить HTTPS

2. **Валидация данных**

   - Проверять входные данные на сервере
   - Использовать антивирус для файлов
   - Ограничить размер сообщений

3. **Защита от атак**
   - Настроить rate limiting
   - Использовать CSRF токены
   - Применять санитизацию HTML

## Оптимизация производительности

1. **База данных**

   - Индексировать часто используемые поля
   - Использовать кэширование
   - Применять пагинацию для истории

2. **SignalR**

   - Настроить transport fallback
   - Оптимизировать размер пакетов
   - Использовать batching

3. **Frontend**
   - Минимизировать JavaScript
   - Оптимизировать CSS
   - Использовать CDN

## Развертывание

### Подготовка к production

1. Обновить строки подключения
2. Настроить логирование
3. Проверить конфигурацию HTTPS

### Варианты развертывания

1. **Azure App Service**

   - Настроить CI/CD
   - Сконфигурировать масштабирование
   - Настроить мониторинг

2. **Docker**
   - Создать Dockerfile
   - Настроить Docker Compose
   - Подготовить контейнеризацию

## Планируемые улучшения

1. **Функциональность**

   - Групповые чаты
   - Приватные сообщения
   - Загрузка файлов
   - Индикаторы статуса пользователей

2. **Технические улучшения**

   - Внедрение кэширования
   - Улучшение обработки ошибок
   - Расширение логирования
   - Добавление unit-тестов

3. **UI/UX**
   - Адаптивный дизайн
   - Темная тема
   - Уведомления
   - Эмодзи и форматирование
